---
title: "p8105_hw2_yw3996"
author: "Yiying Wu"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Load R packages
```{r,include=TRUE,message = FALSE}
library(tidyverse)
```


## Problem 1: FiveThirtyEight data
Clean the data in `pols-month.csv`: 

* Use `separate()` to break up the variable `mon` into integer variables `year`, `month`, and `day` 
* Replace month number with month name
* Create a `president` variable taking values `gop` and `dem`, and remove `prez_dem` and `prez_gop` 
* Remove the `day` variable.
```{r}
pols_month = read_csv("./fivethirtyeight_datasets/pols-month.csv")|>
  janitor::clean_names()|>
  separate(mon,into=c("year","month","day"),)|>
  mutate(month = month.name[as.numeric(month)],
         president=case_match(
           prez_dem,
           1~"democratic",
           0~"republican"
           )
        )|>
  select(-prez_dem,-prez_gop,-day)

head(pols_month)
```

Clean the data in `snp.csv` using a similar process to the above, arrange according to year and month, and organize so that year and month are the leading columns.
```{r}
snp = read_csv("./fivethirtyeight_datasets/snp.csv")|>
  janitor::clean_names()|>
  mutate(
    date=ifelse(as.Date(date,"%m/ %d/ %y")> Sys.Date(),
                format(as.Date(date,"%m/ %d/ %y"),'19%y-%m-%d'),
                format(as.Date(date,"%m/ %d/ %y"),'%Y-%m-%d'))
        )|>
  separate(date,into=c("year","month","day"),)|>
  mutate(month = month.name[as.numeric(month)])|>
  select(year,month, everything(),-day)

head(snp)
```

tidy the `unemployment` data so that it can be merged with the previous datasets: 

* switching from “wide” to “long” format
* ensuring that key variables have the same name
* ensuring that key variables take the same values
```{r}
unemployment = read_csv("./fivethirtyeight_datasets/unemployment.csv")|>
  pivot_longer(
    Jan:Dec,
    names_to = "month", 
    values_to = "unemployment")|>
  janitor::clean_names()|>
  mutate(month=month.name[match(month,month.abb)])|>
  mutate(year=as.character(year))

head(unemployment)

```

Join the datasets by merging `snp` into `pols_month`, and merging `unemployment` into the result.
```{r}
df=pols_month|>
  full_join(snp,by=c("year", "month"))|>
  full_join(unemployment, by=c("year", "month"))

head(df)
```






