---
title: "p8105_hw2_yw3996"
author: "Yiying Wu"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Load R packages
```{r,include=TRUE,message = FALSE}
library(tidyverse)
```


## Problem 1: FiveThirtyEight data
### `pols-month.csv
Clean the data in `pols-month.csv`: 

* Use `separate()` to break up the variable `mon` into integer variables `year`, `month`, and `day` 
* Replace month number with month name
* Create a `president` variable taking values `gop` and `dem`, and remove `prez_dem` and `prez_gop` 
* Remove the `day` variable.
```{r}
pols_month = read_csv("./fivethirtyeight_datasets/pols-month.csv")|>
  janitor::clean_names()|>
  separate(mon,into=c("year","month","day"),)|>
  mutate(month = month.name[as.numeric(month)],
         president=case_match(
           prez_dem,
           1~"democratic",
           0~"republican"
           )
        )|>
  select(-prez_dem,-prez_gop,-day)

pols_month
```

### `snp.csv`
Clean the data in `snp.csv` using a similar process to the above, arrange according to year and month, and organize so that year and month are the leading columns.
```{r}
snp = read_csv("./fivethirtyeight_datasets/snp.csv")|>
  janitor::clean_names()|>
  mutate(
    date=ifelse(as.Date(date,"%m/ %d/ %y")> Sys.Date(),
                format(as.Date(date,"%m/ %d/ %y"),'19%y-%m-%d'),
                format(as.Date(date,"%m/ %d/ %y"),'%Y-%m-%d'))
        )|>
  separate(date,into=c("year","month","day"),)|>
  mutate(month = month.name[as.numeric(month)])|>
  select(year,month, everything(),-day)

snp
```

### `unemployment`
tidy the `unemployment` data so that it can be merged with the previous datasets: 

* switching from “wide” to “long” format
* ensuring that key variables have the same name
* ensuring that key variables take the same values
```{r}
unemployment = read_csv("./fivethirtyeight_datasets/unemployment.csv")|>
  pivot_longer(
    Jan:Dec,
    names_to = "month", 
    values_to = "unemployment")|>
  janitor::clean_names()|>
  mutate(month=month.name[match(month,month.abb)])|>
  mutate(year=as.character(year))

unemployment
```

Join the datasets by merging `snp` into `pols_month`, and merging `unemployment` into the result.
```{r}
df=pols_month|>
  full_join(snp,by=c("year", "month"))|>
  full_join(unemployment, by=c("year", "month"))

df
```

### description of datasets
* `pols_month`: pols_month is a 822 × 9 dataset with variable `year`, `month`, `gov_gop`, `sen_gop`, `rep_gop`, `gov_dem`, `sen_dem`, `rep_dem`, `president`. The `year` variable in this dataset ranges from `r min(pols_month$year)` to `r max(pols_month$year)`.
* `snp`: snp is a 787 × 3 dataset with variable `year`, `month`, `close`. The `year` variable in this dataset ranges from `r min(snp$year)` to `r max(snp$year)`.
* `unemployment`: unemployment is a 816 × 3 dataset with variable `year`, `month`, `unemployment`. The `year` variable in this dataset ranges from `r min(unemployment$year)` to `r max(unemployment$year)`.
* `df`: the joined dataset df is a 828 × 11 dataset with variable `year`, `month`, `gov_gop`, `sen_gop`, `rep_gop`, `gov_dem`, `sen_dem`, `rep_dem`, `president`, `close`, `unemployment`. The `year` variable in this dataset ranges from `r min(df$year)` to `r max(df$year)`.






